// =============================================================================
// User Domain Schema
// =============================================================================
// Admin users for store management (dashboard access).
// ID prefix pattern: usr_ (implemented in service layer)
// All queries MUST be scoped by storeId for multi-tenancy (CRITICAL).
// =============================================================================

enum UserRole {
  OWNER
  ADMIN
  EDITOR
  VIEWER
}

enum UserStatus {
  ACTIVE
  INACTIVE
  INVITED
}

model User {
  id               String      @id @default(cuid())
  email            String      @unique
  name             String?
  passwordHash     String      @map("password_hash")
  role             UserRole    @default(EDITOR)
  status           UserStatus  @default(INVITED)
  lastLoginAt      DateTime?   @map("last_login_at")
  refreshTokenHash String?     @map("refresh_token_hash")
  storeId          String      @map("store_id")
  createdAt        DateTime    @default(now()) @map("created_at")
  updatedAt        DateTime    @updatedAt @map("updated_at")

  // Relations
  store       Store    @relation(fields: [storeId], references: [id], onDelete: Cascade)
  createdKeys ApiKey[]

  // Indexes for multi-tenancy queries
  @@index([storeId])
  @@index([email, storeId])
  @@map("users")
}
